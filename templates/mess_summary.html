{% extends "base.html" %}

{% block content %}

<h2 class="mb-4">ğŸ“Š Today's Mess Summary ({{ today }})</h2>

<!-- ================= TODAY ================= -->

<!-- ===== DELIVERY MEALS ===== -->
<div class="card mb-4 shadow-sm border-primary">
    <div class="card-body">
        <h4 class="card-title mb-3">ğŸšš Delivery Meals (No Cut)</h4>

        <ul class="list-group list-group-flush">
            <li class="list-group-item">
                ğŸŒ™ Ifthaar Only:
                <strong>{{ delivery_ifthaar_count }}</strong>
            </li>
            <li class="list-group-item">
                ğŸŒ™ Athaayam Only:
                <strong>{{ delivery_athaayam_count }}</strong>
            </li>
            <li class="list-group-item">
                ğŸŒ™ Both:
                <strong>{{ delivery_both_count }}</strong>
            </li>
        </ul>

        <div class="mt-2">
            <strong>Total Delivery Meals:</strong>
            {{ delivery_ifthaar_count + delivery_athaayam_count + delivery_both_count }}
        </div>
    </div>
</div>


<!-- ===== NON-DELIVERY MEALS ===== -->
<div class="card mb-4 shadow-sm border-secondary">
    <div class="card-body">
        <h4 class="card-title mb-3">ğŸ½ Non-Delivery Meals (No Cut)</h4>

        <ul class="list-group list-group-flush">
            <li class="list-group-item">
                ğŸŒ™ Ifthaar Only:
                <strong>{{ non_delivery_ifthaar_count }}</strong>
            </li>
            <li class="list-group-item">
                ğŸŒ™ Athaayam Only:
                <strong>{{ non_delivery_athaayam_count }}</strong>
            </li>
            <li class="list-group-item">
                ğŸŒ™ Both:
                <strong>{{ non_delivery_both_count }}</strong>
            </li>
        </ul>

        <div class="mt-2">
            <strong>Total Non-Delivery Meals:</strong>
            {{ non_delivery_ifthaar_count + non_delivery_athaayam_count + non_delivery_both_count }}
        </div>
    </div>
</div>


<!-- ================= DELIVERY USERS ================= -->

<div class="card mb-5 shadow-sm">
    <div class="card-body">

        <h4 class="card-title mb-3">ğŸšš Delivery Users (No Cut)</h4>

        <!-- âœ… FILTER FORM -->
        <form method="GET" class="mb-3">
            <label class="me-2"><strong>Delivery Time:</strong></label>

            <select name="meal_filter" class="form-select w-auto d-inline">
                <option value="ifthaar" {% if meal_filter == "ifthaar" %}selected{% endif %}>Ifthaar</option>
                <option value="athaayam" {% if meal_filter == "athaayam" %}selected{% endif %}>Athaayam</option>
            </select>

            <button type="submit" class="btn btn-primary btn-sm ms-2">
                Apply
            </button>
        </form>

        <!-- âœ… CURRENT MODE -->
        <p>
            Showing delivery list for:
            <span class="badge bg-success text-uppercase">
                {{ meal_filter }}
            </span>
            (Includes BOTH)
        </p>

        {% if delivery_users %}

        <div class="table-responsive">
            <table class="table table-bordered table-striped">
                <thead class="table-primary">
                    <tr>
                        <th>Name</th>
                        <th>Phone</th>
                        <th>Course</th>
                        <th>Address</th>
                        <th>Meal Type</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in delivery_users %}
                    <tr>
                        <td>{{ user.name }}</td>
                        <td>{{ user.phone }}</td>
                        <td>{{ user.course }}</td>
                        <td>{{ user.delivery_address }}</td>
                        <td class="text-capitalize">{{ user.meal_type }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <p class="mt-2">
            <strong>Total Delivery Users:</strong>
            {{ delivery_users|length }}
        </p>

        {% else %}
        <p class="text-danger">No delivery users for this time.</p>
        {% endif %}

    </div>
</div>


<!-- ================= TOMORROW ================= -->

<h2 class="mb-4">ğŸ“… Tomorrow's Meal Requirement ({{ tomorrow }})</h2>


<!-- ===== TOMORROW DELIVERY ===== -->
<div class="card mb-4 shadow-sm border-success">
    <div class="card-body">
        <h4 class="card-title mb-3">ğŸšš Delivery Meals (After Cut)</h4>

        <ul class="list-group list-group-flush">
            <li class="list-group-item">
                ğŸŒ™ Ifthaar Only:
                <strong>{{ t_delivery_ifthaar_count }}</strong>
            </li>
            <li class="list-group-item">
                ğŸŒ™ Athaayam Only:
                <strong>{{ t_delivery_athaayam_count }}</strong>
            </li>
            <li class="list-group-item">
                ğŸŒ™ Both:
                <strong>{{ t_delivery_both_count }}</strong>
            </li>
        </ul>

        <div class="mt-2 fs-5">
            <strong>Total Delivery Tomorrow:</strong>
            {{ t_delivery_ifthaar_count + t_delivery_athaayam_count + t_delivery_both_count }}
        </div>
    </div>
</div>


<!-- ===== TOMORROW NON-DELIVERY ===== -->
<div class="card shadow-sm border-warning">
    <div class="card-body">
        <h4 class="card-title mb-3">ğŸ½ Non-Delivery Meals (After Cut)</h4>

        <ul class="list-group list-group-flush">
            <li class="list-group-item">
                ğŸŒ™ Ifthaar Only:
                <strong>{{ t_non_delivery_ifthaar_count }}</strong>
            </li>
            <li class="list-group-item">
                ğŸŒ™ Athaayam Only:
                <strong>{{ t_non_delivery_athaayam_count }}</strong>
            </li>
            <li class="list-group-item">
                ğŸŒ™ Both:
                <strong>{{ t_non_delivery_both_count }}</strong>
            </li>
        </ul>

        <div class="mt-2 fs-5">
            <strong>Total Non-Delivery Tomorrow:</strong>
            {{ t_non_delivery_ifthaar_count + t_non_delivery_athaayam_count + t_non_delivery_both_count }}
        </div>
    </div>
</div>

{% endblock %}
